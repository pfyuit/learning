<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xmlns:p="http://www.springframework.org/schema/p" xmlns:context="http://www.springframework.org/schema/context"
	xsi:schemaLocation="
     http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.2.xsd
     http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.2.xsd">

	<!-- Configuration for Properties -->
	<bean class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer">
		<property name="locations">
			<list>
				<value>classpath:/config/jdbc.properties</value>
				<value>classpath:/config/memcached.properties</value>
				<value>classpath:/config/redis.properties</value>
				<value>classpath:/config/solr.properties</value>
				<value>classpath:/config/message.properties</value>
			</list>
		</property>
	</bean>

	<!-- Configuration for Scanning -->
	<context:component-scan base-package="com.pfyuit.myjavaee.service"></context:component-scan>

	<!-- Configuration for Destination -->
	<bean id="testQueue" class="org.apache.activemq.command.ActiveMQQueue">
		<constructor-arg value="test.queue"></constructor-arg>
	</bean>

	<bean id="testTopic" class="org.apache.activemq.command.ActiveMQTopic">
		<constructor-arg value="test.topic"></constructor-arg>
	</bean>

	<!-- Configuration for Connection Factory -->
	<bean id="connectinFactory" class="org.apache.activemq.ActiveMQConnectionFactory">
		<property name="brokerURL" value="${activemq.url}" />
	</bean>

	<!-- Configuration for Jms Template -->
	<bean id="jmsTemplate" class="org.springframework.jms.core.JmsTemplate">
		<property name="connectionFactory" ref="connectinFactory" />
	</bean>

	<!-- Configuration for Message Converter -->
	<bean id="messageConverter" class="com.pfyuit.myjavaee.service.DefaultMessageConverter">
	</bean>

	<!-- Configuration for Message Consumer -->
	<bean id="messageConsumer" class="com.pfyuit.myjavaee.service.MessageConsumerImpl">
	</bean>

	<!-- Configuration for Message Listener -->
	<bean id="testQueueMessageListener" class="org.springframework.jms.listener.adapter.MessageListenerAdapter">
		<constructor-arg ref="messageConsumer" />
		<property name="defaultListenerMethod" value="receiveMessage" />
		<property name="messageConverter" ref="messageConverter" />
	</bean>

	<bean id="testTopicMessageListener" class="org.springframework.jms.listener.adapter.MessageListenerAdapter">
		<constructor-arg ref="testTopic" />
		<property name="defaultListenerMethod" value="receiveMessage" />
		<property name="messageConverter" ref="messageConverter" />
	</bean>

	<!-- Configuration for Message Container -->
	<bean id="queueContainer" class="org.springframework.jms.listener.DefaultMessageListenerContainer">
		<property name="connectionFactory" ref="connectinFactory"></property>
		<property name="destination" ref="testQueue"></property>
		<property name="messageListener" ref="testQueueMessageListener"></property>
	</bean>

	<bean id="topicContainer" class="org.springframework.jms.listener.DefaultMessageListenerContainer">
		<property name="connectionFactory" ref="connectinFactory"></property>
		<property name="destination" ref="testTopic"></property>
		<property name="messageListener" ref="testTopicMessageListener"></property>
		<property name="pubSubDomain" value="true" />
	</bean>

	<!-- Configuration for Memcached Client -->
	<bean id="memcachedClient" class="net.spy.memcached.spring.MemcachedClientFactoryBean">
		<property name="servers" value="${memcache.server}" />
		<property name="protocol" value="BINARY" />
		<property name="transcoder">
			<bean class="net.spy.memcached.transcoders.SerializingTranscoder">
				<property name="compressionThreshold" value="1024" />
			</bean>
		</property>
		<property name="opTimeout" value="1000" />
		<property name="timeoutExceptionThreshold" value="1998" />
		<property name="locatorType" value="CONSISTENT" />
		<property name="failureMode" value="Redistribute" />
		<property name="useNagleAlgorithm" value="false" />
	</bean>

	<!-- Configuration for Redis Client -->
	<bean id="jedisPoolConfig" class="redis.clients.jedis.JedisPoolConfig">
		<property name="maxActive" value="${redis.pool.maxActive}" />
		<property name="maxIdle" value="${redis.pool.maxIdle}" />
		<property name="maxWait" value="${redis.pool.maxWait}" />
		<property name="testOnBorrow" value="${redis.pool.testOnBorrow}" />
	</bean>

	<bean id="jedisConnectionFactory" class="org.springframework.data.redis.connection.jedis.JedisConnectionFactory">
		<property name="hostName" value="${redis.ip}" />
		<property name="port" value="${redis.port}" />
		<property name="poolConfig" ref="jedisPoolConfig" />
	</bean>

	<bean class="org.springframework.data.redis.core.RedisTemplate" p:connection-factory-ref="jedisConnectionFactory">
	</bean>

	<!-- Configuration for Bean Validator -->
	<bean id="validator" class="org.springframework.validation.beanvalidation.LocalValidatorFactoryBean" />

</beans>
  